# 画面要件定義 v1: ユーザーレシピ登録・編集（M1-04 / M1-05）

**作成日**: 2026-02-22

---

## 1. 機能要件

| # | 機能 | 説明 |
|---|------|------|
| F01 | ドリンク名入力 | テキスト入力フィールド（必須）。最大100文字。 |
| F02 | 略称コード入力 | テキスト入力フィールド（任意）。最大10文字。半角英数字・記号のみ。 |
| F03 | カテゴリ選択 | セレクトボックス（必須）: ホット / アイス / フラペチーノ / 期間限定 |
| F04 | サブカテゴリ選択 | セレクトボックス（任意）: 既存サブカテゴリ から選択 or テキスト入力 |
| F05 | スリーブトグル | ON/OFF トグルスイッチ（必須。デフォルト: OFF） |
| F06 | 特殊機材・注意事項入力 | テキスト入力（任意）。最大200文字。 |
| F07 | メモ入力 | テキスト入力（任意）。最大500文字。 |
| F08 | ステップ追加 | 「＋ステップを追加」ボタンで末尾にステップカードを追加する |
| F09 | ステップ説明入力 | 各ステップカード内のテキスト入力（必須。最大200文字） |
| F10 | 任意フラグトグル | 「このステップは任意」トグルで required = false に設定する |
| F11 | 材料・分量入力 | 材料名（必須）とS/T/G/V分量（数値0〜99）を入力できる。複数材料追加可。 |
| F12 | ステップ並び替え | ドラッグ&ドロップでステップカードの順序を変更できる |
| F13 | ステップ削除 | ステップカード右上の削除アイコンタップで該当ステップを削除する |
| F14 | 練習対象トグル | 「練習に含める」トグル（デフォルト: ON） |
| F15 | 保存 | バリデーション通過後にDRINK/STEP/INGREDIENTテーブルに保存する |
| F16 | 削除（M1-05のみ） | 確認ダイアログ表示後、レシピとその手順・材料データを全削除する |

## 2. 非機能要件

| # | 項目 | 要件 |
|---|------|------|
| NF01 | ドラッグ&ドロップ | ハプティクスフィードバック付きで60fps以上のスムーズな並び替えを実現 |
| NF02 | 保存速度 | 保存処理を1秒以内に完了すること |
| NF03 | データ整合性 | 保存失敗時にDRINK/STEP/INGREDIENTを全てロールバックすること |

## 3. 表示条件・バリデーション

| 項目 | バリデーションルール |
|------|-------------------|
| ドリンク名 | 必須。1文字以上100文字以内。空白のみは不可。 |
| 略称コード | 任意。入力する場合は半角英数字・記号のみ。最大10文字。 |
| カテゴリ | 必須。未選択のまま保存ボタンを押した場合はエラー表示。 |
| ステップ | 最低1つ以上のステップが必要。0件で保存しようとするとエラー。 |
| ステップ説明 | 各ステップに1文字以上の説明が必要。 |
| 分量 | 0〜99の整数のみ許容。負数・小数は入力不可。 |

## 4. エラーケース

| エラー | 対応 |
|--------|------|
| 必須項目未入力で保存 | 未入力フィールドに赤枠とエラーメッセージを表示。スクロールして最初のエラー位置へ移動。 |
| 保存失敗（SQLiteエラー） | 「保存に失敗しました。もう一度お試しください」トースト通知。データはロールバック。 |
| ステップ0件で保存 | 「手順を最低1つ追加してください」エラー表示 |
| 削除処理失敗 | 「削除に失敗しました」トースト通知。一覧画面には遷移しない。 |
