# 画面要件定義 v1: 振り返り・学習記録（M3-01〜M3-05）

**作成日**: 2026-02-22

---

## 1. 機能要件

### M3-01: 振り返り入力

| # | 機能 | 説明 |
|---|------|------|
| F01 | シフト日入力 | デフォルトは今日の日付。日付ピッカーで変更可能。過去のシフト日も選択可。 |
| F02 | うまくできたこと入力 | 自由記述テキストエリア（任意）。最大500文字。 |
| F03 | 難しかった・ミスしたこと入力 | 自由記述テキストエリア（任意）。最大500文字。 |
| F04 | 先輩・店長からのフィードバック入力 | 自由記述テキストエリア（任意）。最大500文字。 |
| F05 | 次のシフトまでに復習すること入力 | 自由記述テキストエリア（任意）。最大200文字。 |
| F06 | 手応え選択 | 😊（good）/ 😐（okay）/ 😔（bad）の3択（任意）。全体的な手応えを記録する。 |
| F07 | 保存 | 入力内容をREVIEW_NOTEテーブルに保存する |

### M3-02: 振り返り一覧

| # | 機能 | 説明 |
|---|------|------|
| F08 | 日付順カード表示 | REVIEW_NOTEを新しい順にカード表示する |
| F09 | 月別フィルター | ドロップダウンで月を選択して絞り込む |
| F10 | キーワード検索 | 振り返り内容（うまくできたこと・ミス等）のテキスト検索 |
| F11 | カードタップで詳細遷移 | カードタップでM3-03へ遷移する |

### M3-03: 振り返り詳細

| # | 機能 | 説明 |
|---|------|------|
| F12 | 振り返り内容表示 | シフト日・うまくできたこと・ミス・フィードバック・次の復習事項・手応えを表示する |
| F13 | 編集 | 「編集」ボタンでM3-01（編集モード）へ遷移する |
| F14 | 削除 | 確認ダイアログ後にREVIEW_NOTEレコードを削除する |

### M3-04: 間違い問題一覧

| # | 機能 | 説明 |
|---|------|------|
| F15 | 間違いドリンク一覧表示 | WRONG_ANSWER（resolved = false）のドリンクを一覧表示する |
| F16 | ソート機能 | 間違い回数の多い順 / 最終間違い日の新しい順でソート切替 |
| F17 | ドリンク情報表示 | ドリンク名・間違い回数・最終間違い日・最終正解日（なければ「未正解」）を表示 |
| F18 | 再練習開始 | 「間違い問題から練習」ボタンでM3-05へ遷移する |

### M3-05: 間違い問題 再練習

| # | 機能 | 説明 |
|---|------|------|
| F19 | 間違いドリンクのみ出題 | resolved = false のドリンクのみを対象とした練習セッションを構成する |
| F20 | 進捗インジケーター | 「残り N 問」インジケーターを表示する |
| F21 | 正解で消化 | 正解したドリンクのWRONG_ANSWERのresolved = true に更新し、リストから除外する |
| F22 | 全問正解完了 | 全問正解でWRONG_ANSWERが空になったら完了メッセージを表示する |

## 2. 非機能要件

| # | 項目 | 要件 |
|---|------|------|
| NF01 | 保存速度 | 振り返り保存を500ms以内に完了する |
| NF02 | 一覧表示速度 | 振り返り一覧の初期表示を500ms以内に完了する |
| NF03 | 検索レスポンス | 100ms以内にインクリメンタルサーチ結果を更新する |

## 3. 表示条件・バリデーション

| 条件 | 表示内容 |
|------|---------|
| 振り返り記録が0件の場合 | 「まだ振り返りがありません。バイト後に記録してみましょう」を表示 |
| 間違い問題が0件の場合 | 「間違い問題はありません。素晴らしい！」を表示し再練習ボタンを非表示 |
| 全テキストフィールドが空・手応え未選択の場合 | 保存を許可する（すべて任意項目のため） |

## 4. エラーケース

| エラー | 対応 |
|--------|------|
| 振り返り保存失敗 | 「保存に失敗しました。もう一度お試しください」トースト通知 |
| 振り返り削除失敗 | 「削除に失敗しました」トースト通知。一覧に戻らない。 |
| 間違い問題データ取得失敗 | 「データを読み込めませんでした」表示＋再試行ボタン |
