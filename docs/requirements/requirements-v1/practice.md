# 画面要件定義 v1: 実践練習（M2-01〜M2-05）

**作成日**: 2026-02-22

---

## 1. 機能要件

### M2-01: 練習設定

| # | 機能 | 説明 |
|---|------|------|
| F01 | 難易度選択 | 初級 / 中級 / 上級 から1つを選択する（デフォルト: 初級） |
| F02 | カテゴリ選択 | ホット / アイス / フラペチーノ / 全カテゴリ から選択する（デフォルト: 全カテゴリ） |
| F03 | 練習開始 | 選択条件でオーダーを10件ランダム生成し、M2-02へ遷移する |

### M2-02: オーダー一覧（並び替え）

| # | 機能 | 説明 |
|---|------|------|
| F04 | 10オーダー生成・表示 | 難易度・カテゴリ条件に従ってランダム生成した10オーダーをカード形式で表示する |
| F05 | ドラッグ&ドロップ並び替え | ユーザーが作業順を並び替えできる |
| F06 | 解答例表示 | 「効率的な順番例」と解説テキストを表示・非表示切替できる |
| F07 | 確定 | 並び替え後に最初の問題（M2-03）へ遷移する |

### M2-03: 手順並び替え問題

| # | 機能 | 説明 |
|---|------|------|
| F08 | 問題表示 | ドリンク名・サイズ・カスタム内容・問題番号（例: 3/10）をヘッダーに表示する |
| F09 | シャッフルステップ表示 | 正しい手順をシャッフルしてカードリストで表示する |
| F10 | ドラッグ&ドロップ回答 | ユーザーがカードを並び替えて回答する |
| F11 | 制限時間（設定ON時） | 残り時間をプログレスバーで表示。0になると自動採点する |
| F12 | 回答提出 | 「回答する」ボタンタップで採点処理を実行しM2-04へ遷移する |

### M2-04: 問題フィードバック

| # | 機能 | 説明 |
|---|------|------|
| F13 | 正誤表示 | 全ステップが正しい順序であれば正解、1つでも違えば不正解と判定する |
| F14 | 差分表示 | 自分の回答と正解を並べ、違いを赤/緑でカラーコード表示する |
| F15 | 解説テキスト | 不正解の場合、どのステップが誤りだったかの解説文を表示する |
| F16 | PRACTICE_RESULT記録 | 正誤・回答内容をPRACTICE_RESULTテーブルに保存する |
| F17 | 間違い自動登録 | 不正解のドリンクをWRONG_ANSWERテーブルに追記（間違い回数をインクリメント）する |
| F18 | 次の問題へ | 「次の問題へ」ボタンで次オーダーの問題（M2-03）へ遷移する |

### M2-05: 練習セッション結果

| # | 機能 | 説明 |
|---|------|------|
| F19 | 正解率表示 | 10問中の正解数と割合をアニメーションゲージで表示する |
| F20 | 苦手ドリンクリスト | 今回不正解だったドリンクの一覧を表示する |
| F21 | カテゴリ別正解率 | ホット/アイス/フラペ別の正解率を棒グラフで表示する |
| F22 | 経験値・ストリーク | 今回獲得した経験値と連続正解ストリーク数を表示する |
| F23 | PRACTICE_SESSION保存 | セッション全体の結果（正解数・所要時間等）をPRACTICE_SESSIONに保存する |
| F24 | 振り返りCTA | 「今日の振り返りを記録する」ボタンでM3-01へ遷移する |
| F25 | 習得ステータス更新 | 直近5セッションで全正解のドリンクを「習得済み」に自動更新する |

## 2. 非機能要件

| # | 項目 | 要件 |
|---|------|------|
| NF01 | オーダー生成速度 | 設定確定から10オーダー生成・表示まで1秒以内 |
| NF02 | ドラッグ&ドロップ | ハプティクスフィードバック付き、60fps以上のスムーズな操作 |
| NF03 | データ保存 | セッション終了後のデータ保存処理を500ms以内に完了 |
| NF04 | 練習中のナビ非表示 | M2-02〜M2-04の画面ではボトムナビゲーションを非表示にする |

## 3. 表示条件・バリデーション

| 条件 | 処理 |
|------|------|
| 選択カテゴリにドリンクが存在しない | 「該当カテゴリのドリンクがありません。カテゴリを変更してください」表示 |
| ユーザー登録レシピが練習対象ONの場合 | システム組込みレシピと同様にランダム選択対象に含める |
| 難易度: 初級 | カスタムなし、ホット系のみ対象 |
| 難易度: 中級 | 30%の確率でカスタムあり、ホット+アイス対象 |
| 難易度: 上級 | 60%の確率でカスタムあり、全カテゴリ対象 |

## 4. エラーケース

| エラー | 対応 |
|--------|------|
| オーダー生成失敗 | 「練習を開始できませんでした。設定を確認してください」表示＋設定画面に戻る |
| セッション結果保存失敗 | 「結果の保存に失敗しましたが、練習は正常に終了しました」トースト通知 |
| 制限時間切れ | 自動的に現在の回答で採点してM2-04へ遷移する |
